//
//  AppDetailsController.swift
//  Office
//
//  Created by GA GA on 22/05/2017.
//  Copyright © 2017 roger. All rights reserved.
//

import UIKit
import CoreFramework

class AppDetailsController: UIViewController {
    
    let cellId1 = "cellId1"
    let cellId2 = "cellId2"
    let cellId3 = "cellId3"
    var yyid = ""
    
    
    var tableView = UITableView(frame: .zero, style: .plain)
    
    init(yyid: String) {
        super.init(nibName: nil, bundle: nil)
        self.yyid = yyid
    }
    
    required init?(coder aDecoder: NSCoder) {
        fatalError("init(coder:) has not been implemented")
    }
    
    override func viewDidLoad() {
        super.viewDidLoad()
        
        title = "应用详情"
        navigationController?.navigationBar.topItem?.backBarButtonItem = UIBarButtonItem(title: "", style: UIBarButtonItemStyle.plain, target: nil, action: nil)
        
        view.addSubview(tableView)
        tableView.delegate = self
        tableView.dataSource = self
        tableView.separatorStyle = .none
        tableView.estimatedRowHeight = 44
        tableView.snp.makeConstraints { (make) in
            make.bottom.equalTo(view)
            make.left.equalTo(view)
            make.right.equalTo(view)
            make.top.equalTo(view)
        }
        tableView.register(AppListCell.self, forCellReuseIdentifier: cellId1)
        tableView.register(AppIntroductionCell.self, forCellReuseIdentifier: cellId2)
//        tableView.register(AppInformationCell.self, forCellReuseIdentifier: cellId3)
        
        getData()
    }
    
}

extension AppDetailsController: UITableViewDelegate, UITableViewDataSource {
//    func numberOfSections(in tableView: UITableView) -> Int {
//        return 1
//    }
    
    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
        return 10
    }
    
//    func tableView(_ tableView: UITableView, estimatedHeightForRowAt indexPath: IndexPath) -> CGFloat {
//        return 44
//    }
    
    func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
        
    }
    
//    func tableView(_ tableView: UITableView, heightForHeaderInSection section: Int) -> CGFloat {
//        return 0.0001
//    }
//    
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
        
        if indexPath.row == 0 {
            let cell = tableView.dequeueReusableCell(withIdentifier: cellId1, for: indexPath) as! AppListCell
            return cell
        } else if indexPath.row == 1 {
            let cell = tableView.dequeueReusableCell(withIdentifier: cellId2, for: indexPath) as! AppIntroductionCell
            return cell
        } else {
            //            let cell = tableView.dequeueReusableCell(withIdentifier: cellId3, for: indexPath) as! AppInformationCell
            let cell = UITableViewCell.init(style: .value1, reuseIdentifier: cellId3)
            cell.selectionStyle = .none
//            tableView.rowHeight = 30
            let names = ["信息", "        建设方：", "        大小：", "        版本：", "        更新日期：", "        类别：", "        兼容性：", "        开发商："]
            let images = ["ying_yong_jie_shao", "", "", "", "", "", "", ""]
            cell.imageView?.image = UIImage.init(named: images[indexPath.row - 2])
            cell.textLabel?.text = names[indexPath.row - 2]
            cell.textLabel?.font = UIFont.systemFont(ofSize: 14)
//            cell.detailTextLabel?.text = "详情"
            return cell
        }
        
    }
}


extension AppDetailsController {
    func getData() {
        var s = ""
        let para : [String: Any]

        s += "<yyxqfwRequestFrom>"
        s += "<zhxx>\(25109231221)</zhxx>"
        s += "<yyid>\(self.yyid)</yyid>"
        s += "</yyxqfwRequestFrom>"
        
        para = paraMaker(data: ["tranId":"SCDS.HLWGZPT.MH.YYXQ","s": s], sid: "D6666", extra: [:])
        Network.post(parameter: para, success: { (json) in
            print(json)
        }) { (error) in
            print(error)
        }
//        follow()
    }
    
    func follow() {
        var s = ""
        let para : [String: Any]
        
        s += "<yygzfwRequestFrom>"
        s += "<zhxx>\(25109231221)</zhxx>"
        s += "<yyid>\(yyid)</yyid>"
        s += "<sfgz>\(01)</sfgz>"
        s += "</yygzfwRequestFrom>"
        
        para = paraMaker(data: ["tranId":"SCDS.HLWGZPT.MH.YYGZ","s": s], sid: "D6666", extra: [:])
        Network.post(parameter: para, success: { (json) in
            print(json)
        }) { (error) in
            print(error)
        }

    }
}

